<!DOCTYPE html>
<html lang="it">
<head>
  <title>Semaforo</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" type="text/css" href="bootstrap-4.2.1-dist/css/bootstrap.min.css">
  <style>
    #trafficLightContainer {
      height: 150px;
    }

    #trafficLight {
      height: 100%;
    }

  </style>
</head>
<body>
  <div class="container">
    <div id="trafficLightContainer"><img id="trafficLight" src="img/red.png" /></div>
    
    <button id="button" type="button" class="btn btn-primary" onclick="nextState()">Chiedi di passare</button>
  </div>
<script src="jquery-3.3.1.js"></script>
<script>
  var trafficLightState = 'red-ready'

  function nextState() {
    switch (trafficLightState) {
      case 'green':
        trafficLightState = 'yellow'
        $('#trafficLight').attr('src', "img/yellow.png")
        setTimeout(nextState, 2000)
        break
      case 'yellow':
        trafficLightState = 'red-disabled'
        $('#trafficLight').attr('src', "img/red.png")
        setTimeout(nextState, 5000)
        break
      case 'red-disabled':
        trafficLightState = 'red-ready'
        $('#button').prop("disabled",false)
        break
      case 'red-ready':
        trafficLightState = 'green'
        $('#button').prop("disabled",true)
        $('#trafficLight').attr('src', "img/green.png")
        setTimeout(nextState, 3000)
        break        
    }
  }

</script>

</script>
</body>
</html>